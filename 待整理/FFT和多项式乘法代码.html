<html>
<head>
  <title>Evernote Export</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/600986 (zh-CN, DDL); Windows/10.0.0 (Win64); EDAMVersion=V2;"/>
  <meta name="application-data:2525275" content="10389191/s94/26c12955-d2ab-4af2-97b6-1e271dc36d6a/www.evernote.com"/>
  <meta name="application-data:corenote-hostUUID" content="71624E67-E7FB-4532-8DF1-B09AA57AB1CB"/>
  <meta name="application-data:corenote-localUUID" content="0B123CC6-BCF7-4FD0-AFE5-18C71D237C54"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="529"/>

<div>
<span><div><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #008f00"><a href="FFT和多项式乘法代码_files/FFT.cpp"><img src="FFT和多项式乘法代码_files/87cd1d9125d12891272d9c161d0154ca.png" alt="FFT.cpp"></a></span></div><div><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #008f00"><br/></span></div><div><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #008f00">// </span><span style="font: 11.0px 'PingFang SC'; font-variant-ligatures: no-common-ligatures; color: #008f00">迭代形式的</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #008f00">FFT</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000"><br/>
</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #3495af">vector</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000">&lt;</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #3495af">Complex</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000">&gt; FFT(</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #0433ff">const</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000"> </span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #3495af">vector</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000">&lt;</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #3495af">Complex</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000">&gt; &amp;P, </span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #0433ff">bool</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000"> forward = </span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #0433ff">true</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000">)<br/>
{<br/>    </span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #0433ff">int</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000"> n = (</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #0433ff">int</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000">)P.</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #3495af">size</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000">();<br/>    </span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #0433ff">int</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000"> level = (</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #0433ff">int</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000">)(</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #3495af">log</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000">(n) / </span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #3495af">log</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000">(2.0));<br/>    <br/>    </span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #3495af">vector</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000">&lt;</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #3495af">Complex</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000">&gt; A(n);<br/>    </span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #0433ff">for</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000"> (</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #0433ff">int</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000"> i = 0; i &lt; n; ++i) {<br/>        A[</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #3495af">bit_revert</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000">(</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #3495af">i</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000">, </span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #3495af">level</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000">)] = P[</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #3495af">i</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000">];<br/>    }<br/>    <br/>    </span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #0433ff">int</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000"> wfactor = forward ? 1 : -1;<br/>    <br/>    </span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #008f00">// </span><span style="font: 11.0px 'PingFang SC'; font-variant-ligatures: no-common-ligatures; color: #008f00">叶子层</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #008f00">L = 0</span><span style="font: 11.0px 'PingFang SC'; font-variant-ligatures: no-common-ligatures; color: #008f00">，在初始化</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #008f00">A</span><span style="font: 11.0px 'PingFang SC'; font-variant-ligatures: no-common-ligatures; color: #008f00">的时候已经计算完毕，因为长度为</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #008f00">1</span><span style="font: 11.0px 'PingFang SC'; font-variant-ligatures: no-common-ligatures; color: #008f00">的多项式</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #008f00">FFT</span><span style="font: 11.0px 'PingFang SC'; font-variant-ligatures: no-common-ligatures; color: #008f00">等于自己</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000"><br/>    </span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #008f00">// L = 1 to level</span><span style="font: 11.0px 'PingFang SC'; font-variant-ligatures: no-common-ligatures; color: #008f00">，逐层向上更新</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000"><br/>    </span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #008f00">// </span><span style="font: 11.0px 'PingFang SC'; font-variant-ligatures: no-common-ligatures; color: #008f00">每一层有</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #008f00"> p = n &gt;&gt; L</span><span style="font: 11.0px 'PingFang SC'; font-variant-ligatures: no-common-ligatures; color: #008f00">个部分，每个部分长度</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #008f00"> m = 1 &lt;&lt; L</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000"><br/>    </span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #0433ff">for</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000"> (</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #0433ff">int</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000"> L = 1; L &lt;= level; ++L) {<br/>        </span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #0433ff">int</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000"> m = 1 &lt;&lt; L;<br/>        </span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #0433ff">auto</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000"> wm = </span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #3495af">Complex</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000">::</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #3495af">W</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000">(m, wfactor);<br/>        </span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #0433ff">for</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000"> (</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #0433ff">int</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000"> sp = 0; sp &lt; n; sp += m) {     </span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #008f00">// sp </span><span style="font: 11.0px 'PingFang SC'; font-variant-ligatures: no-common-ligatures; color: #008f00">是每个部分的开始下标</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000"><br/>            </span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #3495af">Complex</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000"> w(1);<br/>            </span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #0433ff">for</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000"> (</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #0433ff">int</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000"> k = 0; k &lt; m &gt;&gt; 1; ++k) {<br/>                </span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #008f00">// </span><span style="font: 11.0px 'PingFang SC'; font-variant-ligatures: no-common-ligatures; color: #008f00">蝴蝶运算</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000"><br/>                </span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #008f00">// </span><span style="font: 11.0px 'PingFang SC'; font-variant-ligatures: no-common-ligatures; color: #008f00">每次只更新</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #008f00"> A[sp+k] </span><span style="font: 11.0px 'PingFang SC'; font-variant-ligatures: no-common-ligatures; color: #008f00">和</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #008f00"> A[sp+k+(m&gt;&gt;1)]</span><span style="font: 11.0px 'PingFang SC'; font-variant-ligatures: no-common-ligatures; color: #008f00">，没有其他项参与</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000"><br/>                </span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #3495af">Complex</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000"> u = A[</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #3495af">sp</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000">+</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #3495af">k</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000">];<br/>                </span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #3495af">Complex</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000"> t = w * A[</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #3495af">sp</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000">+</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #3495af">k</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000">+(</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #3495af">m</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000">&gt;&gt;1)];<br/>                A[</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #3495af">sp</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000">+</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #3495af">k</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000">] = u + t;<br/>                A[</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #3495af">sp</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000">+</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #3495af">k</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000">+(</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #3495af">m</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000">&gt;&gt;1)] = u - t;<br/>                w *= wm;<br/>            }<br/>        }<br/>    }<br/>    <br/>    </span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #0433ff">if</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000"> (!forward) {<br/>        </span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #0433ff">for</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000"> (</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #0433ff">auto</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000"> &amp;x : A)<br/>            x /= n;<br/>    }<br/>    <br/>    </span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #0433ff">return</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000"> A;<br/>
}<br/>
</span><br/></div><div><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #008f00">// </span><span style="font: 11.0px 'PingFang SC'; font-variant-ligatures: no-common-ligatures; color: #008f00">递归形式的</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #008f00">FFT</span><span style="font: 11.0px 'PingFang SC'; font-variant-ligatures: no-common-ligatures; color: #008f00">，基于递归代码便于推算出迭代形式的</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #008f00">FFT</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000"><br/>
</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #008f00">// P</span><span style="font: 11.0px 'PingFang SC'; font-variant-ligatures: no-common-ligatures; color: #008f00">是多项式的系数表达式，需满足</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #008f00">P</span><span style="font: 11.0px 'PingFang SC'; font-variant-ligatures: no-common-ligatures; color: #008f00">的长度是</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #008f00">2</span><span style="font: 11.0px 'PingFang SC'; font-variant-ligatures: no-common-ligatures; color: #008f00">的幂</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000"><br/>
</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #3495af">vector</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000">&lt;</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #3495af">Complex</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000">&gt; FFTRecursive(</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #0433ff">const</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000"> </span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #3495af">vector</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000">&lt;</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #3495af">Complex</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000">&gt; &amp;P)<br/>
{<br/>    </span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #0433ff">int</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000"> n = (</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #0433ff">int</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000">)P.</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #3495af">size</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000">();<br/>    </span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #0433ff">if</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000"> (n == 1) {<br/>        </span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #0433ff">return</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000"> {{P[0]}};<br/>    }<br/>
<br/>    </span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #0433ff">auto</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000"> Wn = </span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #3495af">Complex</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000">::</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #3495af">W</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000">(n);<br/>    </span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #3495af">Complex</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000"> W(1);<br/>    </span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #3495af">vector</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000">&lt;</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #3495af">Complex</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000">&gt; A0, A1;<br/>    </span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #0433ff">for</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000"> (</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #3495af">size_t</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000"> i = 0; i &lt; P.</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #3495af">size</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000">(); i+=2) {<br/>        A0.</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #3495af">push_back</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000">(P[</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #3495af">i</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000">]);<br/>        A1.</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #3495af">push_back</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000">(P[</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #3495af">i</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000">+1]);<br/>    }<br/>
<br/>    </span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #0433ff">auto</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000"> Y0 = </span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #3495af">FFTRecursive</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000">(A0);<br/>    </span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #0433ff">auto</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000"> Y1 = </span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #3495af">FFTRecursive</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000">(A1);<br/>    </span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #3495af">vector</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000">&lt;</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #3495af">Complex</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000">&gt; Y;<br/>    Y.</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #3495af">resize</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000">(P.</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #3495af">size</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000">());<br/>
<br/>    </span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #0433ff">for</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000"> (</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #0433ff">int</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000"> k = 0; k &lt; n &gt;&gt; 1; ++k) {<br/>        Y[</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #3495af">k</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000">] = Y0[</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #3495af">k</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000">] + W * Y1[</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #3495af">k</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000">];<br/>        Y[</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #3495af">k</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000">+(</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #3495af">n</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000">&gt;&gt;1)] = Y0[</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #3495af">k</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000">] - W * Y1[</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #3495af">k</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000">];<br/>        W *= Wn;<br/>    }<br/>
<br/>    </span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #0433ff">return</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000"> Y;<br/>
}</span><br/></div><div><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #000000"><br/></span></div><div><br/></div></span>
</div></body></html> 